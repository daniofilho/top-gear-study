var Xt=Object.defineProperty;var jt=(o,i,s)=>i in o?Xt(o,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[i]=s;var m=(o,i,s)=>(jt(o,typeof i!="symbol"?i+"":i,s),s),Gt=(o,i,s)=>{if(!i.has(o))throw TypeError("Cannot "+s)};var t=(o,i,s)=>(Gt(o,i,"read from private field"),s?s.call(o):i.get(o)),e=(o,i,s)=>{if(i.has(o))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(o):i.set(o,s)},r=(o,i,s,n)=>(Gt(o,i,"write to private field"),n?n.call(o,s):i.set(o,s),s),Vt=(o,i,s,n)=>({set _(h){r(o,i,h,s)},get _(){return t(o,i,n)}});(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))n(h);new MutationObserver(h=>{for(const a of h)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&n(f)}).observe(document,{childList:!0,subtree:!0});function s(h){const a={};return h.integrity&&(a.integrity=h.integrity),h.referrerpolicy&&(a.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?a.credentials="include":h.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(h){if(h.ep)return;h.ep=!0;const a=s(h);fetch(h.href,a)}})();const c={fps:30,canvas:{width:400,height:300}},It=({context:o})=>({rectangle:({color:i,x:s,y:n,height:h,width:a})=>{o.beginPath(),o.fillStyle=i,o.fillRect(s,n,a,h)},image:({x:i,y:s,height:n,width:h,image:a,destinationX:f,destinationY:Pt,destinationWidth:U,destinationHeight:D})=>{o.imageSmoothingEnabled=!1,o.drawImage(a,i,s,h,n,f,Pt,U,D)},text:({color:i,x:s,y:n,text:h,fontSize:a})=>{o.font=`${a} Arial`,o.fillStyle=i,o.fillText(h,s,n)}});var u,A,x,w,v,lt,y,dt,Q,b,V,R,K,S,gt,k,mt,xt,vt,yt,St;class Ht{constructor({context:i,car:s,track:n}){e(this,u,void 0);e(this,A,void 0);e(this,x,void 0);e(this,w,{height:c.canvas.height*.4,color:"#0000A0"});e(this,v,{color:"#020080",size:{min:t(this,w).height*.3,max:t(this,w).height*.9}});e(this,lt,new Array(c.canvas.height/1.5).fill(""));e(this,y,Math.round((c.canvas.height-t(this,w).height)/t(this,lt).length));e(this,dt,new Array(c.canvas.width).fill(""));e(this,Q,c.canvas.width/t(this,dt).length);e(this,b,{color:"#555555",width:c.canvas.width*1/2});e(this,V,{colors:["#058900","#076C02"],frequency:60});e(this,R,{colors:["#940000","#CECECE"],width:t(this,b).width*.1,frequency:60});e(this,K,c.canvas.width);e(this,S,0);e(this,gt,1);e(this,k,0);e(this,mt,.4);e(this,xt,i=>{if(!t(this,x)||!t(this,A)||i<=t(this,x).coordinates[t(this,S)].distance)return;let s=t(this,S)+1;s>t(this,x).coordinates.length-1&&(s=0,Vt(this,gt)._++,t(this,A).positionOnTrack=0),r(this,S,s)});e(this,vt,(i,s)=>{if(!t(this,A))return;const n=Math.abs(i-s)>=.8;t(this,A).isOutOfTrack=n});e(this,yt,i=>{let s=0,n=-1;const a=1-n;return s=(i-n)*100/a/100,s});e(this,St,i=>{const s=t(this,w).height*.003,n=t(this,yt).call(this,i);let h=t(this,v).size.min+n*t(this,w).height,a="up",f=0;t(this,dt).map((Pt,U)=>{!t(this,u)||(a==="down"?h+=s:h-=s,h>t(this,v).size.max&&(h=t(this,v).size.max,a="up"),h<=t(this,v).size.min&&(h=t(this,v).size.min,a="down"),t(this,u).rectangle({color:t(this,w).color,x:f,y:0,width:t(this,Q),height:h}),t(this,u).rectangle({color:t(this,v).color,x:f,y:h,width:t(this,Q),height:t(this,w).height-h}),f=U+t(this,Q))})});m(this,"render",({deltaTime:i})=>{if(!t(this,A))return;const n=t(this,A).speed/100,h=t(this,A).positionOnTrack,a=t(this,A).position,f=t(this,S)===0?"#999":t(this,b).color;t(this,xt).call(this,h),t(this,St).call(this,t(this,k)),t(this,lt).map((Pt,U)=>{if(!t(this,u)||!t(this,A)||!t(this,x))return;const D=t(this,w).height+U*t(this,y);let I=U/(c.canvas.height/2);I=.04+I*.8;let bt=t(this,x).coordinates[t(this,S)].curvature;bt=bt*t(this,mt);const Yt=bt-t(this,k);r(this,k,t(this,k)+Yt*i*n/1200),t(this,vt).call(this,a,t(this,k));const qt=.5+t(this,k)*Math.pow(1-I,3),ot=t(this,K)*qt,Lt=t(this,b).width*I,P={...t(this,b),x:ot-Lt,width:Lt,color:f},at=t(this,R).width*I,J={...t(this,R),color:Math.sin(t(this,R).frequency*Math.pow(1-I,2)+h*2)>0?t(this,R).colors[0]:t(this,R).colors[1],left:{x:ot-P.width-at},right:{x:ot+P.width},width:at},zt=t(this,K)/2-at,Nt=ot-P.width-at,ct={...t(this,V),width:zt,color:Math.sin(t(this,V).frequency*Math.pow(1-I,2)+h*2)>0?t(this,V).colors[0]:t(this,V).colors[1],right:{x:ot+P.width+at},left:{width:Nt}};t(this,u).rectangle({color:ct.color,x:0,y:D,width:ct.left.width,height:t(this,y)}),t(this,u).rectangle({color:J.color,x:J.left.x,y:D,width:J.width,height:t(this,y)}),t(this,u).rectangle({color:P.color,x:P.x,y:D,width:P.width*2,height:t(this,y)}),t(this,u).rectangle({color:ct.color,x:ct.right.x,y:D,width:t(this,K)-ct.right.x,height:t(this,y)}),t(this,u).rectangle({color:J.color,x:J.right.x,y:D,width:J.width,height:t(this,y)})})});r(this,u,It({context:i})),r(this,A,s),r(this,x,n)}get trackSection(){return t(this,S)}get curvature(){return t(this,k)}get lap(){return t(this,gt)}}u=new WeakMap,A=new WeakMap,x=new WeakMap,w=new WeakMap,v=new WeakMap,lt=new WeakMap,y=new WeakMap,dt=new WeakMap,Q=new WeakMap,b=new WeakMap,V=new WeakMap,R=new WeakMap,K=new WeakMap,S=new WeakMap,gt=new WeakMap,k=new WeakMap,mt=new WeakMap,xt=new WeakMap,vt=new WeakMap,yt=new WeakMap,St=new WeakMap;const Ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAABmBAMAAACO8FTTAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAACRQTFRFAAAAAAAAuLjYmJi42Nj46Oj4+Pj4SEhoaGiIeBgYyMjoCAgIPSVNpwAAAAx0Uk5TAP//////////////CcRQJgAAA49JREFUeJzdl79T2zAUx+PSPwBF+cE1SyOHoVslBcIxgWMzF4g9N4V4xuQ4ekwN7R3M3Rh7DNx1Y+afq57107HcrR14gxMrXz/Jenqf+6bV+p8REK6DbPp+Hx8jHd2pR9HJ+t8530NwKRaH9QTZ/Ou9jrveopail/evbRT5vPLrRhwnae5GOovjj1YwDnk92NQKIorqgUd2hikihAydNbTFPRqbOd6EMDCEx8T08FHes/da8FbOAI+KueFDznFgMtAPD8N9dx34sf3wE5sMgRQ4a5ACs1mB5x0grGBW3SW1V4kVxP6wglAsSwwcqtQd8V0smVlBlMaRs1WwC6M4HbkZMAGBqjYICK1kiEJUFJiqMmHa7yM2cjJEnKPVCtPfMjDd2kKcOwJR7v7TE9Z7ienNTSHKbQWY8H6/j81RoEVRcEKdncRkMplws4V8uVyKVVrBixy/LuBciou8fXEEEM8B2oSqiMvmoByxgvIe2SPYQuUT9uhXa2fq23p9ERALGDb0CDBPbGPMaD3BUBJmtSUy7OFFTdFBuw5hVmuE2QjRMcrnTmehozNHsZFROOlp5rbNIo2TUyXYyU9x5EEM31aA6GT5eejrTXYgBe04O6fQCw7nCmgTDYhLcnRCoVfgqV6ez+ET7jUgblk6LVNChiXnE8hQDqg10HZ3Crx4dOffB6goweUQSYG7Blfwhfb+jphL2k2TrI6YxeyTFDDabUCMes1begUsHosRnVt8FS+mX/OSXsXbs5jYrYJtInFyojJg+kNkYDC4pcoN30OTAdFxPCJAFa4IQDkAh0QqQ4BYHPKSKu8kYn6VwOFM4x7dsoiXVDGAAOBYBgVLzsKSKiYAOGxoBIVIFwqqmHONBXBYaBrewFywpTyRqpgvViARIzhRogIuFcQogQMMtIaYwTpigsFrRYzrYRjxMMb1MDtTXnMgwc5ZCRfwMHe9Gaql6ObIAOa+yGlnLQXOD92+Eg18jEP940bqczAI7RrC+B0MzhbqTDY4mDyfqXU0OJh8FilBg4PJInIhBXKGmoNJTtg3JfA7mKRtEOR3MIdIT9GAlx5in6WgwcGkiKkMDXhJkG7eBgeTFPotGhyMEFzoDF4HE6/0qWlwMDHVDoP5HYyooSp3x+tgIrbShwp5HQznhT5RXgcjpjWCwbMsZ9XBON1fGpRnZB2M8jRGIGni8CMYVAUlwwYVj1OO+P5D/Iv4A8FL0be3qqe0AAAAAElFTkSuQmCC",Jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAAiBAMAAAAaORypAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAA9QTFRFAAAAyMjomJi4aGiISEho2ANYBgAAAAV0Uk5TAP////8c0CZSAAAAe0lEQVR4nO2MwRXCIBBEg1KAJBZgggUkO1sAyvRfk7t6MZGTZz77Hsv8eQxDp9NpkPLaFmdJfoURj0vLhytmFyFrWlqFJVV5F8AR/PXETHjhBGZ9Tke/3asQN9tiJrgd/yAmi6X4XtVO1vLtYxVP9fNgpM2+wEKbXfYvLy4MEXjodMHGAAAAAElFTkSuQmCC";var L,G,ut,At,ft,Y,p,E,wt,W,l,q,kt,Mt,M,Z,$,C,z,Tt;class Qt{constructor({context:i}){e(this,L,void 0);e(this,G,c.canvas.width*.25);e(this,ut,c.canvas.height*.2);e(this,At,c.canvas.height-c.canvas.height*.22);e(this,ft,.5);e(this,Y,2);e(this,p,0);e(this,E,0);e(this,wt,0);e(this,W,0);e(this,l,0);e(this,q,100);e(this,kt,c.canvas.width/2);e(this,Mt,c.canvas.width-t(this,G));e(this,M,!1);e(this,Z,null);e(this,$,null);e(this,C,{width:63,height:34,idle:{x:0,y:0},left:{x:0,y:34},right:{x:0,y:68}});e(this,z,"idle");m(this,"turnLeft",()=>{if(t(this,l)<=0)return;r(this,z,"left");let i=t(this,E)-t(this,ft)*t(this,l)/1e3;i<-1&&(i=-1),r(this,E,i)});m(this,"turnRight",()=>{if(t(this,l)<=0)return;r(this,z,"right");let i=t(this,E)+t(this,ft)*t(this,l)/1e3;i>1&&(i=1),r(this,E,i)});m(this,"accelerate",i=>{let s=t(this,q);if(t(this,M)&&(s=t(this,q)/3),t(this,M)&&t(this,l)>s)return this.slowDown(i);t(this,Y),t(this,M);let n=t(this,l)+t(this,Y)*i;n>=t(this,q)&&(n=t(this,q)),this.speed=n});m(this,"slowDown",i=>{let s=0;const n=t(this,Y)*2;s=t(this,l)-n*i,s<=0&&(s=0),this.speed=s});m(this,"break",i=>{let s=t(this,l)-t(this,Y)*5*i;s<=0&&(s=0),this.speed=s});e(this,Tt,()=>t(this,C)[t(this,z)]);m(this,"render",({deltaTime:i,levelCurvature:s})=>{if(!t(this,L)||!t(this,Z)||!t(this,$))return;r(this,p,t(this,E)-s*3),t(this,p)<-1&&r(this,p,-1),t(this,p)>1&&r(this,p,1);let n=t(this,kt)+t(this,Mt)*t(this,p)/2-t(this,G)/2;const h=t(this,Tt).call(this);t(this,L).image({image:t(this,Z),height:t(this,C).height,width:t(this,C).width,y:h.y,x:h.x,destinationHeight:t(this,ut),destinationWidth:t(this,G),destinationX:n,destinationY:t(this,At)}),t(this,M)&&t(this,L).image({image:t(this,$),height:t(this,C).height,width:t(this,C).width,y:h.y,x:h.x,destinationHeight:t(this,ut),destinationWidth:t(this,G),destinationX:n,destinationY:t(this,At)});const a=t(this,l)/30*i;t(this,l)>0&&r(this,wt,t(this,wt)+a),r(this,W,t(this,W)+a)});r(this,L,It({context:i}));const s=new Image;s.src=Ut,s.onload=()=>{r(this,Z,s)};const n=new Image;n.src=Jt,n.onload=()=>{r(this,$,n)}}get speed(){return t(this,l)}set speed(i){r(this,l,i)}get position(){return t(this,p)}set position(i){r(this,p,i)}get positionOnTrack(){return t(this,W)}set positionOnTrack(i){r(this,W,i)}get distanceTraveled(){return t(this,wt)}get isOutOfTrack(){return t(this,M)}set isOutOfTrack(i){r(this,M,i)}set carDirection(i){r(this,z,i)}}L=new WeakMap,G=new WeakMap,ut=new WeakMap,At=new WeakMap,ft=new WeakMap,Y=new WeakMap,p=new WeakMap,E=new WeakMap,wt=new WeakMap,W=new WeakMap,l=new WeakMap,q=new WeakMap,kt=new WeakMap,Mt=new WeakMap,M=new WeakMap,Z=new WeakMap,$=new WeakMap,C=new WeakMap,z=new WeakMap,Tt=new WeakMap;var F,T,N,pt,_,tt,Ot;class Kt{constructor({context:i,car:s,level:n,canvasWidth:h}){e(this,F,void 0);e(this,T,void 0);e(this,N,void 0);e(this,pt,0);e(this,_,!0);e(this,tt,0);e(this,Ot,3);m(this,"render",({deltaTime:i})=>{!t(this,F)||!t(this,T)||!t(this,N)||(t(this,F).text({color:"#FFFFFF",text:`Distance Traveled: ${Math.floor(t(this,T).distanceTraveled)}`,y:20,x:10,fontSize:"12px"}),t(this,F).text({color:"#FFFFFF",text:`Position on Level: ${Math.floor(t(this,T).positionOnTrack)}`,y:40,x:10,fontSize:"12px"}),t(this,F).text({color:"#FFFFFF",text:`Speed: ${Math.floor(t(this,T).speed)}`,y:60,x:10,fontSize:"12px"}),t(this,F).text({color:"#FFFFFF",text:`Track section: ${Math.floor(t(this,N).trackSection)}`,y:80,x:10,fontSize:"12px"}),t(this,F).text({color:"#FFFFFF",text:`Lap: ${Math.floor(t(this,N).lap)}`,y:100,x:10,fontSize:"12px"}),t(this,T).distanceTraveled<=10&&(t(this,_)&&t(this,F).text({color:"#FFFFFF",text:"Use Arrow Keys to move!",y:150,x:t(this,pt)/2-110,fontSize:"20px"}),r(this,tt,t(this,tt)+i),t(this,tt)>t(this,Ot)&&(r(this,_,!t(this,_)),r(this,tt,0))))});r(this,F,It({context:i})),r(this,T,s),r(this,N,n),r(this,pt,h)}}F=new WeakMap,T=new WeakMap,N=new WeakMap,pt=new WeakMap,_=new WeakMap,tt=new WeakMap,Ot=new WeakMap;const Wt={name:"Test track",coordinates:[{curvature:0,distance:5},{curvature:0,distance:20},{curvature:1,distance:50},{curvature:0,distance:200},{curvature:.4,distance:250},{curvature:.8,distance:400},{curvature:-1,distance:550},{curvature:-.7,distance:700},{curvature:0,distance:750},{curvature:.5,distance:900}]};var X,it,j,Ft,et,st,H,g,d,B,ht,rt,O,Rt,Et,Ct,Bt,nt,Dt;class Zt{constructor(){e(this,X,0);e(this,it,0);e(this,j,c.fps);e(this,Ft,t(this,j));e(this,et,0);e(this,st,1e3/c.fps);e(this,H,document.getElementById("canvas"));e(this,g,t(this,H).getContext("2d"));e(this,d,void 0);e(this,B,void 0);e(this,ht,void 0);e(this,rt,void 0);e(this,O,{});e(this,Rt,()=>{window.addEventListener("keydown",i=>{t(this,O)[i.key]=!0},!1),window.addEventListener("keyup",i=>{t(this,O)[i.key]=!1},!1)});e(this,Et,i=>{!t(this,d)||(t(this,O).ArrowLeft?t(this,d).turnLeft():t(this,O).ArrowRight?t(this,d).turnRight():t(this,d).carDirection="idle",t(this,O).ArrowUp?t(this,d).accelerate(i):t(this,O).ArrowDown?t(this,d).break(i):t(this,d).slowDown(i))});e(this,Ct,()=>{t(this,g).beginPath(),t(this,g).rect(0,0,c.canvas.width,c.canvas.height),t(this,g).fillStyle="black",t(this,g).fill(),t(this,g).shadowBlur=0});e(this,Bt,i=>{!t(this,g)||!t(this,B)||!t(this,d)||!t(this,ht)||!t(this,rt)||(t(this,Ct).call(this),t(this,B).render({deltaTime:i}),t(this,d).render({deltaTime:i,levelCurvature:t(this,B).curvature}),t(this,ht).render({deltaTime:i}),t(this,Et).call(this,i),t(this,rt).text({color:"#FFFFFF",text:`FPS: ${t(this,j).toFixed(0)}`,y:20,x:c.canvas.width-50,fontSize:"12px"}))});e(this,nt,i=>{if(i<t(this,it)+1e3/c.fps){requestAnimationFrame(t(this,nt));return}for(r(this,X,t(this,X)+(i-t(this,it))),r(this,it,i),i>t(this,Ft)+1e3&&(r(this,j,.25*t(this,et)+.75*t(this,j)),r(this,Ft,i),r(this,et,0)),Vt(this,et)._++;t(this,X)>=t(this,st);)r(this,X,t(this,X)-t(this,st));t(this,Bt).call(this,t(this,X)/t(this,st)),requestAnimationFrame(t(this,nt))});e(this,Dt,()=>{t(this,nt).call(this,0)});m(this,"run",()=>{t(this,Rt).call(this),t(this,Dt).call(this)});t(this,g).imageSmoothingEnabled=!1,t(this,H).width=c.canvas.width,t(this,H).height=c.canvas.height,r(this,d,new Qt({context:t(this,g)})),r(this,B,new Ht({context:t(this,g),car:t(this,d),track:Wt})),r(this,ht,new Kt({context:t(this,g),car:t(this,d),level:t(this,B),canvasWidth:t(this,H).width})),r(this,rt,It({context:t(this,g)}))}}X=new WeakMap,it=new WeakMap,j=new WeakMap,Ft=new WeakMap,et=new WeakMap,st=new WeakMap,H=new WeakMap,g=new WeakMap,d=new WeakMap,B=new WeakMap,ht=new WeakMap,rt=new WeakMap,O=new WeakMap,Rt=new WeakMap,Et=new WeakMap,Ct=new WeakMap,Bt=new WeakMap,nt=new WeakMap,Dt=new WeakMap;window.onload=function(){(()=>{new Zt().run()})()};
