var Xt=Object.defineProperty;var Ht=(a,i,s)=>i in a?Xt(a,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[i]=s;var x=(a,i,s)=>(Ht(a,typeof i!="symbol"?i+"":i,s),s),$t=(a,i,s)=>{if(!i.has(a))throw TypeError("Cannot "+s)};var t=(a,i,s)=>($t(a,i,"read from private field"),s?s.call(a):i.get(a)),e=(a,i,s)=>{if(i.has(a))throw TypeError("Cannot add the same private member more than once");i instanceof WeakSet?i.add(a):i.set(a,s)},r=(a,i,s,n)=>($t(a,i,"write to private field"),n?n.call(a,s):i.set(a,s),s),Wt=(a,i,s,n)=>({set _(h){r(a,i,h,s)},get _(){return t(a,i,n)}});(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))n(h);new MutationObserver(h=>{for(const o of h)if(o.type==="childList")for(const w of o.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&n(w)}).observe(document,{childList:!0,subtree:!0});function s(h){const o={};return h.integrity&&(o.integrity=h.integrity),h.referrerpolicy&&(o.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?o.credentials="include":h.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(h){if(h.ep)return;h.ep=!0;const o=s(h);fetch(h.href,o)}})();const c={fps:30,canvas:{width:400,height:300}},Dt=({context:a})=>({rectangle:({color:i,x:s,y:n,height:h,width:o})=>{a.beginPath(),a.fillStyle=i,a.fillRect(s,n,o,h)},image:({x:i,y:s,height:n,width:h,image:o,destinationX:w,destinationY:It,destinationWidth:B,destinationHeight:A})=>{a.imageSmoothingEnabled=!1,a.drawImage(o,i,s,h,n,w,It,B,A)},text:({color:i,x:s,y:n,text:h,fontSize:o})=>{a.font=`${o} Arial`,a.fillStyle=i,a.fillText(h,s,n)}});var f,g,y,p,F,lt,S,dt,Y,E,W,M,_,k,ut,O,xt,yt,Ft,St,kt;class Ut{constructor({context:i,car:s,track:n}){e(this,f,void 0);e(this,g,void 0);e(this,y,void 0);e(this,p,{height:c.canvas.height*.4,color:"#0000A0"});e(this,F,{color:"#020080",size:{min:t(this,p).height*.3,max:t(this,p).height*.9}});e(this,lt,new Array(c.canvas.height/1.5).fill(""));e(this,S,Math.round((c.canvas.height-t(this,p).height)/t(this,lt).length));e(this,dt,new Array(c.canvas.width).fill(""));e(this,Y,c.canvas.width/t(this,dt).length);e(this,E,{color:"#555555",width:c.canvas.width*1/2});e(this,W,{colors:["#058900","#076C02"],frequency:60});e(this,M,{colors:["#940000","#CECECE"],width:t(this,E).width*.1,frequency:60});e(this,_,c.canvas.width);e(this,k,0);e(this,ut,1);e(this,O,0);e(this,xt,.4);e(this,yt,i=>{if(!t(this,y)||!t(this,g)||i<=t(this,y).coordinates[t(this,k)].distance)return;let s=t(this,k)+1;s>t(this,y).coordinates.length-1&&(s=0,Wt(this,ut)._++,t(this,g).positionOnTrack=0),r(this,k,s)});e(this,Ft,(i,s)=>{if(!t(this,g))return;const n=Math.abs(i-s)>=.8;t(this,g).isOutOfTrack=n});e(this,St,i=>{let s=0,n=-1;const o=1-n;return s=(i-n)*100/o/100,s});e(this,kt,i=>{const s=t(this,p).height*.003,n=t(this,St).call(this,i);let h=t(this,F).size.min+n*t(this,p).height,o="up",w=0;t(this,dt).map((It,B)=>{!t(this,f)||(o==="down"?h+=s:h-=s,h>t(this,F).size.max&&(h=t(this,F).size.max,o="up"),h<=t(this,F).size.min&&(h=t(this,F).size.min,o="down"),t(this,f).rectangle({color:t(this,p).color,x:w,y:0,width:t(this,Y),height:h}),t(this,f).rectangle({color:t(this,F).color,x:w,y:h,width:t(this,Y),height:t(this,p).height-h}),w=B+t(this,Y))})});x(this,"render",({deltaTime:i})=>{if(!t(this,g))return;const n=t(this,g).speed/100,h=t(this,g).positionOnTrack,o=t(this,g).position,w=t(this,k)===0?"#999":t(this,E).color;t(this,yt).call(this,h),t(this,kt).call(this,t(this,O)),t(this,lt).map((It,B)=>{if(!t(this,f)||!t(this,g)||!t(this,y))return;const A=t(this,p).height+B*t(this,S);let D=B/(c.canvas.height/2);D=.04+D*.8;let Et=t(this,y).coordinates[t(this,k)].curvature;Et=Et*t(this,xt);const Gt=Et-t(this,O);r(this,O,t(this,O)+Gt*i*n/1200),t(this,Ft).call(this,o,t(this,O));const Nt=.5+t(this,O)*Math.pow(1-D,3),at=t(this,_)*Nt,qt=t(this,E).width*D,I={...t(this,E),x:at-qt,width:qt,color:w},ot=t(this,M).width*D,K={...t(this,M),color:Math.sin(t(this,M).frequency*Math.pow(1-D,2)+h*2)>0?t(this,M).colors[0]:t(this,M).colors[1],left:{x:at-I.width-ot},right:{x:at+I.width},width:ot},Rt=t(this,_)/2-ot,Vt=at-I.width-ot,ct={...t(this,W),width:Rt,color:Math.sin(t(this,W).frequency*Math.pow(1-D,2)+h*2)>0?t(this,W).colors[0]:t(this,W).colors[1],right:{x:at+I.width+ot},left:{width:Vt}};t(this,f).rectangle({color:ct.color,x:0,y:A,width:ct.left.width,height:t(this,S)}),t(this,f).rectangle({color:K.color,x:K.left.x,y:A,width:K.width,height:t(this,S)}),t(this,f).rectangle({color:I.color,x:I.x,y:A,width:I.width*2,height:t(this,S)}),t(this,f).rectangle({color:ct.color,x:ct.right.x,y:A,width:t(this,_)-ct.right.x,height:t(this,S)}),t(this,f).rectangle({color:K.color,x:K.right.x,y:A,width:K.width,height:t(this,S)})})});r(this,f,Dt({context:i})),r(this,g,s),r(this,y,n)}get trackSection(){return t(this,k)}get curvature(){return t(this,O)}get lap(){return t(this,ut)}}f=new WeakMap,g=new WeakMap,y=new WeakMap,p=new WeakMap,F=new WeakMap,lt=new WeakMap,S=new WeakMap,dt=new WeakMap,Y=new WeakMap,E=new WeakMap,W=new WeakMap,M=new WeakMap,_=new WeakMap,k=new WeakMap,ut=new WeakMap,O=new WeakMap,xt=new WeakMap,yt=new WeakMap,Ft=new WeakMap,St=new WeakMap,kt=new WeakMap;var q,$,ft,gt,wt,G,v,P,pt,j,l,N,Ot,Tt,T,J,Q,b,R,Lt;class Bt{constructor({context:i}){e(this,q,void 0);e(this,$,c.canvas.width*.25);e(this,ft,c.canvas.height*.2);e(this,gt,c.canvas.height-c.canvas.height*.22);e(this,wt,.5);e(this,G,2);e(this,v,0);e(this,P,0);e(this,pt,0);e(this,j,0);e(this,l,0);e(this,N,100);e(this,Ot,c.canvas.width/2);e(this,Tt,c.canvas.width-t(this,$));e(this,T,!1);e(this,J,null);e(this,Q,null);e(this,b,{width:63,height:34,idle:{x:0,y:0},left:{x:0,y:34},right:{x:0,y:68}});e(this,R,"idle");x(this,"turnLeft",()=>{if(t(this,l)<=0)return;r(this,R,"left");let i=t(this,P)-t(this,wt)*t(this,l)/1e3;i<-1&&(i=-1),r(this,P,i)});x(this,"turnRight",()=>{if(t(this,l)<=0)return;r(this,R,"right");let i=t(this,P)+t(this,wt)*t(this,l)/1e3;i>1&&(i=1),r(this,P,i)});x(this,"accelerate",i=>{let s=t(this,N);if(t(this,T)&&(s=t(this,N)/3),t(this,T)&&t(this,l)>s)return this.slowDown(i);t(this,G),t(this,T);let n=t(this,l)+t(this,G)*i;n>=t(this,N)&&(n=t(this,N)),this.speed=n});x(this,"slowDown",i=>{let s=0;const n=t(this,G)*2;s=t(this,l)-n*i,s<=0&&(s=0),this.speed=s});x(this,"break",i=>{let s=t(this,l)-t(this,G)*5*i;s<=0&&(s=0),this.speed=s});e(this,Lt,()=>t(this,b)[t(this,R)]);x(this,"render",({deltaTime:i,levelCurvature:s})=>{if(!t(this,q)||!t(this,J)||!t(this,Q))return;r(this,v,t(this,P)-s*3),t(this,v)<-1&&r(this,v,-1),t(this,v)>1&&r(this,v,1);let n=t(this,Ot)+t(this,Tt)*t(this,v)/2-t(this,$)/2;const h=t(this,Lt).call(this);t(this,q).image({image:t(this,J),height:t(this,b).height,width:t(this,b).width,y:h.y,x:h.x,destinationHeight:t(this,ft),destinationWidth:t(this,$),destinationX:n,destinationY:t(this,gt)}),t(this,T)&&t(this,q).image({image:t(this,Q),height:t(this,b).height,width:t(this,b).width,y:h.y,x:h.x,destinationHeight:t(this,ft),destinationWidth:t(this,$),destinationX:n,destinationY:t(this,gt)});const o=t(this,l)/30*i;t(this,l)>0&&r(this,pt,t(this,pt)+o),r(this,j,t(this,j)+o)});r(this,q,Dt({context:i}));const s=new Image;s.src="assets/images/car-white.png",s.onload=()=>{r(this,J,s)};const n=new Image;n.src="assets/images/car-dirt.png",n.onload=()=>{r(this,Q,n)}}get speed(){return t(this,l)}set speed(i){r(this,l,i)}get position(){return t(this,v)}set position(i){r(this,v,i)}get positionOnTrack(){return t(this,j)}set positionOnTrack(i){r(this,j,i)}get distanceTraveled(){return t(this,pt)}get isOutOfTrack(){return t(this,T)}set isOutOfTrack(i){r(this,T,i)}set carDirection(i){r(this,R,i)}}q=new WeakMap,$=new WeakMap,ft=new WeakMap,gt=new WeakMap,wt=new WeakMap,G=new WeakMap,v=new WeakMap,P=new WeakMap,pt=new WeakMap,j=new WeakMap,l=new WeakMap,N=new WeakMap,Ot=new WeakMap,Tt=new WeakMap,T=new WeakMap,J=new WeakMap,Q=new WeakMap,b=new WeakMap,R=new WeakMap,Lt=new WeakMap;var m,L,V,vt,Z,tt,Ct;class Kt{constructor({context:i,car:s,level:n,canvasWidth:h}){e(this,m,void 0);e(this,L,void 0);e(this,V,void 0);e(this,vt,0);e(this,Z,!0);e(this,tt,0);e(this,Ct,3);x(this,"render",({deltaTime:i})=>{!t(this,m)||!t(this,L)||!t(this,V)||(t(this,m).text({color:"#FFFFFF",text:`Distance Traveled: ${Math.floor(t(this,L).distanceTraveled)}`,y:20,x:10,fontSize:"12px"}),t(this,m).text({color:"#FFFFFF",text:`Position on Level: ${Math.floor(t(this,L).positionOnTrack)}`,y:40,x:10,fontSize:"12px"}),t(this,m).text({color:"#FFFFFF",text:`Speed: ${Math.floor(t(this,L).speed)}`,y:60,x:10,fontSize:"12px"}),t(this,m).text({color:"#FFFFFF",text:`Track section: ${Math.floor(t(this,V).trackSection)}`,y:80,x:10,fontSize:"12px"}),t(this,m).text({color:"#FFFFFF",text:`Lap: ${Math.floor(t(this,V).lap)}`,y:100,x:10,fontSize:"12px"}),t(this,L).distanceTraveled<=10&&(t(this,Z)&&t(this,m).text({color:"#FFFFFF",text:"Use Arrow Keys to move!",y:150,x:t(this,vt)/2-110,fontSize:"20px"}),r(this,tt,t(this,tt)+i),t(this,tt)>t(this,Ct)&&(r(this,Z,!t(this,Z)),r(this,tt,0))))});r(this,m,Dt({context:i})),r(this,L,s),r(this,V,n),r(this,vt,h)}}m=new WeakMap,L=new WeakMap,V=new WeakMap,vt=new WeakMap,Z=new WeakMap,tt=new WeakMap,Ct=new WeakMap;const Yt={name:"Test track",coordinates:[{curvature:0,distance:5},{curvature:0,distance:20},{curvature:1,distance:50},{curvature:0,distance:200},{curvature:.4,distance:250},{curvature:.8,distance:400},{curvature:-1,distance:550},{curvature:-.7,distance:700},{curvature:0,distance:750},{curvature:.5,distance:900}]};var X,it,H,mt,et,st,U,u,d,z,ht,rt,C,Mt,Pt,bt,zt,nt,At;class _t{constructor(){e(this,X,0);e(this,it,0);e(this,H,c.fps);e(this,mt,t(this,H));e(this,et,0);e(this,st,1e3/c.fps);e(this,U,document.getElementById("canvas"));e(this,u,t(this,U).getContext("2d"));e(this,d,void 0);e(this,z,void 0);e(this,ht,void 0);e(this,rt,void 0);e(this,C,{});e(this,Mt,()=>{window.addEventListener("keydown",i=>{t(this,C)[i.key]=!0},!1),window.addEventListener("keyup",i=>{t(this,C)[i.key]=!1},!1)});e(this,Pt,i=>{!t(this,d)||(t(this,C).ArrowLeft?t(this,d).turnLeft():t(this,C).ArrowRight?t(this,d).turnRight():t(this,d).carDirection="idle",t(this,C).ArrowUp?t(this,d).accelerate(i):t(this,C).ArrowDown?t(this,d).break(i):t(this,d).slowDown(i))});e(this,bt,()=>{t(this,u).beginPath(),t(this,u).rect(0,0,c.canvas.width,c.canvas.height),t(this,u).fillStyle="black",t(this,u).fill(),t(this,u).shadowBlur=0});e(this,zt,i=>{!t(this,u)||!t(this,z)||!t(this,d)||!t(this,ht)||!t(this,rt)||(t(this,bt).call(this),t(this,z).render({deltaTime:i}),t(this,d).render({deltaTime:i,levelCurvature:t(this,z).curvature}),t(this,ht).render({deltaTime:i}),t(this,Pt).call(this,i),t(this,rt).text({color:"#FFFFFF",text:`FPS: ${t(this,H).toFixed(0)}`,y:20,x:c.canvas.width-50,fontSize:"12px"}))});e(this,nt,i=>{if(i<t(this,it)+1e3/c.fps){requestAnimationFrame(t(this,nt));return}for(r(this,X,t(this,X)+(i-t(this,it))),r(this,it,i),i>t(this,mt)+1e3&&(r(this,H,.25*t(this,et)+.75*t(this,H)),r(this,mt,i),r(this,et,0)),Wt(this,et)._++;t(this,X)>=t(this,st);)r(this,X,t(this,X)-t(this,st));t(this,zt).call(this,t(this,X)/t(this,st)),requestAnimationFrame(t(this,nt))});e(this,At,()=>{t(this,nt).call(this,0)});x(this,"run",()=>{t(this,Mt).call(this),t(this,At).call(this)});t(this,u).imageSmoothingEnabled=!1,t(this,U).width=c.canvas.width,t(this,U).height=c.canvas.height,r(this,d,new Bt({context:t(this,u)})),r(this,z,new Ut({context:t(this,u),car:t(this,d),track:Yt})),r(this,ht,new Kt({context:t(this,u),car:t(this,d),level:t(this,z),canvasWidth:t(this,U).width})),r(this,rt,Dt({context:t(this,u)}))}}X=new WeakMap,it=new WeakMap,H=new WeakMap,mt=new WeakMap,et=new WeakMap,st=new WeakMap,U=new WeakMap,u=new WeakMap,d=new WeakMap,z=new WeakMap,ht=new WeakMap,rt=new WeakMap,C=new WeakMap,Mt=new WeakMap,Pt=new WeakMap,bt=new WeakMap,zt=new WeakMap,nt=new WeakMap,At=new WeakMap;window.onload=function(){(()=>{new _t().run()})()};
